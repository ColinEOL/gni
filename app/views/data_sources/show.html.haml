%h1
  = data_source_logo(@data_source) 
  = "Names Source: " + @data_source.title

- last_import_scheduler_id = @last_import_scheduler.id rescue 0
- scheduler_status = @last_import_scheduler.message rescue "nothing yet"

#data_source_import_status{:import_scheduler_id => last_import_scheduler_id}= scheduler_status

%h3 Changes introduced by the last update
%p
  = (link_to "Inserted: #{@inserted_size}, ", data_source_import_data_source_import_details_url(@inserted, :page => 1)) rescue "Inserted: 0, "
  = (link_to "Deleted: #{@deleted_size}, ", data_source_import_data_source_import_details_url(@deleted)) rescue  "Deleted: 0, "
  = (link_to "Updated: #{@updated_size}", data_source_import_data_source_import_details_url(@updated)) rescue "Updated: 0"
  

%p
  = link_to 'Repositories Overlap',data_source_data_source_overlaps_url(@data_source)

%p
  %b Description:
  =h @data_source.description
%p
  %b Logo URL
  =h @data_source.logo_url
%p
  %b Data url:
  =h @data_source.data_url
%p
  %b Refresh period (days):
  =h @data_source.refresh_period_days
- form_for(@import_scheduler, :action => 'post') do |f|
  = f.hidden_field :data_source_id,  :value => @data_source.id
  = f.hidden_field :status, :value => ImportScheduler::WAITING
  = f.hidden_field :message, :value => 'Added to the cue'
  = f.submit "Import data"

-if @data_source.contributor?(current_user)
  = link_to 'Edit', edit_data_source_path(@data_source)
  = "|"
= link_to 'Back', data_sources_path
